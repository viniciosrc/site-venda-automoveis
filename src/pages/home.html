<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Velocità | Pesquisa de Veículos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="../css/styleHome.css">
    <style>
        
    </style>
</head>
<body>

    <header class="main-header">
        <div class="header-content">
            <a href="#" class="logo-container">
                <img class="logo-home-velocita" src="../assets/image/logovelocita-home.png" alt="logoHome velocita">
            </a>

            <nav class="main-nav">
                <a href="#" class="nav-link">Comprar</a>
                <a href="cadastro_veiculos.html" class="nav-link">Vender</a>
                <a href="tabela_Fipe.html" class="nav-link">Tabela Fipe</a>
                <a href="#" class="nav-link">Ajuda</a>
            </nav>

            <div class="access-icons">
                <a href="login_card.html" class="access-link">
                    <i class="fas fa-user-circle access-icon"></i>
                    <a href="../pages/cadastro.html" class="access-text">Entrar & Cadastrar</a>
                </a>
                
                <a href="#" class="favorite-link">
                    <i class="fas fa-heart favorite-icon"></i>
                </a>
            </div>
        </div>
    </header>

    <main class="search-main">
        <div class="search-card">
            <h2 class="search-title">Pesquise seu automóvel</h2>

            <div class="filter-buttons">
                <button class="filter-btn active">Carros</button>
                <button class="filter-btn">Motos</button>
            </div>

            <div class="search-input-group">
                <i class="fas fa-search search-icon"></i>
                <input 
                    type="text" 
                    placeholder="Busque pela marca ou tipo" 
                    class="search-input"
                    aria-label="Busca de veículos"
                    id="searchInput"
                >
            </div>
        </div>
    </main>

    <section class="section-title-container">
        <h2 class="section-title">Marcas & Concessionárias</h2>
    </section>

    <section class="brands-carousel">
        <div class="carousel-container">
            <button class="carousel-arrow" id="prevBtn">
                <i class="fas fa-chevron-left"></i>
            </button>
            
            <div class="brands-wrapper">
                <div class="brands-list">
                    <div class="brand-item">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/90/Mercedes-Logo.svg/200px-Mercedes-Logo.svg.png" alt="Mercedes-Benz">
                    </div>
                    <div class="brand-item">
                        <img src="https://logos-world.net/wp-content/uploads/2021/03/Chevrolet-Logo.png" alt="Chevrolet">
                    </div>
                    <div class="brand-item">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/44/Hyundai_Motor_Company_logo.svg/200px-Hyundai_Motor_Company_logo.svg.png" alt="Hyundai">
                    </div>
                    <div class="brand-item">
                        <img src="https://images.seeklogo.com/logo-png/23/2/peugeot-logo-png_seeklogo-233749.png" alt="Peugeot">
                    </div>
                    <div class="brand-item">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/Honda.svg/200px-Honda.svg.png" alt="Honda">
                    </div>
                    <div class="brand-item">
                        <img src="https://logodownload.org/wp-content/uploads/2014/05/fiat-logo-2.png" alt="Fiat">
                    </div>
                    <div class="brand-item">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Ford_logo_flat.svg/200px-Ford_logo_flat.svg.png" alt="Ford">
                    </div>
                    <div class="brand-item">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/b/b7/Renault_2021_Text.svg" alt="Renault">
                    </div>            
                </div>
            </div>
            
            <button class="carousel-arrow" id="nextBtn">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </section>

    <section class="filter-section">
        <div class="filter-card">
            <div class="filter-header">
                <i class="fas fa-filter filter-icon"></i>
                <h3 class="filter-title">Pesquisa por Filtro</h3>
            </div>
            
            <div class="filter-search-group">
                <i class="fas fa-search search-icon"></i>
                <input 
                    type="text" 
                    placeholder="Buscar carros..." 
                    class="search-input"
                    id="filterSearchInputSmall"
                >
            </div>
            <div class="filter-grid">
                <button class="filter-button" data-filter="marca">Marca</button>
                <button class="filter-button" data-filter="categoria">Categoria</button>
                <button class="filter-button" data-filter="situacao">Situação</button>
                <button class="filter-button" data-filter="cor">Cor</button>
                <button class="filter-button" data-filter="tamanho">Tamanho</button>
                <button class="filter-button" data-filter="localizacao">Localização</button>
            </div>
            
            <div class="show-more">▼ Mostrar mais ▼</div>
        </div>
    </section>

    <section class="active-filters" id="activeFilters">
        </section>

    <div class="modal" id="modalMarca">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-car"></i>
                    Selecione a Marca
                </h3>
                <button class="modal-close" onclick="closeModal('modalMarca')">&times;</button>
            </div>
            <div class="modal-search-box">
                <input type="text" class="modal-search-input" placeholder="Buscar marca..." id="searchMarca">
            </div>
            <div class="modal-options" id="optionsMarca">
                <div class="modal-option" data-value="mercedes">Mercedes-Benz</div>
                <div class="modal-option" data-value="chevrolet">Chevrolet</div>
                <div class="modal-option" data-value="hyundai">Hyundai</div>
                <div class="modal-option" data-value="peugeot">Peugeot</div>
                <div class="modal-option" data-value="honda">Honda</div>
                <div class="modal-option" data-value="fiat">Fiat</div>
                <div class="modal-option" data-value="volkswagen">Volkswagen</div>
                <div class="modal-option" data-value="toyota">Toyota</div>
                <div class="modal-option" data-value="ford">Ford</div>
                <div class="modal-option" data-value="renault">Renault</div>
                <div class="modal-option" data-value="bmw">BMW</div>
                <div class="modal-option" data-value="audi">Audi</div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-clear" onclick="clearModalSelection('marca')">Limpar</button>
                <button class="modal-btn modal-btn-apply" onclick="applyFilter('marca')">Aplicar</button>
            </div>
        </div>
    </div>

    <div class="modal" id="modalCategoria">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-list"></i>
                    Selecione a Categoria
                </h3>
                <button class="modal-close" onclick="closeModal('modalCategoria')">&times;</button>
            </div>
            <div class="modal-search-box">
                <input type="text" class="modal-search-input" placeholder="Buscar categoria..." id="searchCategoria">
            </div>
            <div class="modal-options" id="optionsCategoria">
                <div class="modal-option" data-value="sedan">Sedan</div>
                <div class="modal-option" data-value="hatch">Hatch</div>
                <div class="modal-option" data-value="suv">SUV</div>
                <div class="modal-option" data-value="picape">Picape</div>
                <div class="modal-option" data-value="coupe">Cupê</div>
                <div class="modal-option" data-value="conversivel">Conversível</div>
                <div class="modal-option" data-value="minivan">Minivan</div>
                <div class="modal-option" data-value="esportivo">Esportivo</div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-clear" onclick="clearModalSelection('categoria')">Limpar</button>
                <button class="modal-btn modal-btn-apply" onclick="applyFilter('categoria')">Aplicar</button>
            </div>
        </div>
    </div>

    <div class="modal" id="modalSituacao">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-check-circle"></i>
                    Selecione a Situação
                </h3>
                <button class="modal-close" onclick="closeModal('modalSituacao')">&times;</button>
            </div>
            <div class="modal-options" id="optionsSituacao">
                <div class="modal-option" data-value="novo">Novo</div>
                <div class="modal-option" data-value="seminovo">Seminovo</div>
                <div class="modal-option" data-value="usado">Usado</div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-clear" onclick="clearModalSelection('situacao')">Limpar</button>
                <button class="modal-btn modal-btn-apply" onclick="applyFilter('situacao')">Aplicar</button>
            </div>
        </div>
    </div>

    <div class="modal" id="modalCor">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-palette"></i>
                    Selecione a Cor
                </h3>
                <button class="modal-close" onclick="closeModal('modalCor')">&times;</button>
            </div>
            <div class="modal-search-box">
                <input type="text" class="modal-search-input" placeholder="Buscar cor..." id="searchCor">
            </div>
            <div class="modal-options" id="optionsCor">
                <div class="modal-option" data-value="branco">Branco</div>
                <div class="modal-option" data-value="preto">Preto</div>
                <div class="modal-option" data-value="prata">Prata</div>
                <div class="modal-option" data-value="cinza">Cinza</div>
                <div class="modal-option" data-value="vermelho">Vermelho</div>
                <div class="modal-option" data-value="azul">Azul</div>
                <div class="modal-option" data-value="verde">Verde</div>
                <div class="modal-option" data-value="amarelo">Amarelo</div>
                <div class="modal-option" data-value="laranja">Laranja</div>
                <div class="modal-option" data-value="marrom">Marrom</div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-clear" onclick="clearModalSelection('cor')">Limpar</button>
                <button class="modal-btn modal-btn-apply" onclick="applyFilter('cor')">Aplicar</button>
            </div>
        </div>
    </div>

    <div class="modal" id="modalTamanho">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-ruler"></i>
                    Selecione o Tamanho
                </h3>
                <button class="modal-close" onclick="closeModal('modalTamanho')">&times;</button>
            </div>
            <div class="modal-options" id="optionsTamanho">
                <div class="modal-option" data-value="compacto">Compacto</div>
                <div class="modal-option" data-value="medio">Médio</div>
                <div class="modal-option" data-value="grande">Grande</div>
                <div class="modal-option" data-value="extra-grande">Extra Grande</div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-clear" onclick="clearModalSelection('tamanho')">Limpar</button>
                <button class="modal-btn modal-btn-apply" onclick="applyFilter('tamanho')">Aplicar</button>
            </div>
        </div>
    </div>

    <div class="modal" id="modalLocalizacao">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-map-marker-alt"></i>
                    Selecione a Localização
                </h3>
                <button class="modal-close" onclick="closeModal('modalLocalizacao')">&times;</button>
            </div>
            <div class="modal-search-box">
                <input type="text" class="modal-search-input" placeholder="Buscar localização..." id="searchLocalizacao">
            </div>
            <div class="modal-options" id="optionsLocalizacao">
                <div class="modal-option" data-value="sp">São Paulo</div>
                <div class="modal-option" data-value="rj">Rio de Janeiro</div>
                <div class="modal-option" data-value="mg">Minas Gerais</div>
                <div class="modal-option" data-value="rs">Rio Grande do Sul</div>
                <div class="modal-option" data-value="pr">Paraná</div>
                <div class="modal-option" data-value="ba">Bahia</div>
                <div class="modal-option" data-value="sc">Santa Catarina</div>
                <div class="modal-option" data-value="pe">Pernambuco</div>
                <div class="modal-option" data-value="ce">Ceará</div>
                <div class="modal-option" data-value="go">Goiás</div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-clear" onclick="clearModalSelection('localizacao')">Limpar</button>
                <button class="modal-btn modal-btn-apply" onclick="applyFilter('localizacao')">Aplicar</button>
            </div>
        </div>
    </div>

    <section class="products-section">
        <div class="products-grid" id="productsGrid">
        </div>
    </section>

    <script>
        // Dados de exemplo de produtos
        const products = [
            {
                id: 1,
                name: "BMW 320I M Sport Activeflex",
                year: 2020,
                km: 0,
                price: 185000,
                // Caminho da imagem do ID 1
                image: "https://img.olx.com.br/images/10/106591701263748.webp" 
            },
            {
                id: 2,
                name: "Chevrolet Onix Plus",
                year: 2024,
                km: 5000,
                price: 89900,
                image: "https://images.unsplash.com/photo-1605559424843-9e4c228bf1c2?w=400"
            },
            {
                id: 3,
                name: "Hyundai HB20S",
                year: 2023,
                km: 12000,
                price: 78000,
                image: "https://i0.statig.com.br/bancodeimagens/b5/ct/xh/b5ctxh69h2z4bcc6mihkhb6ev.jpg"
            },
            {
                id: 4,
                name: "Peugeot 208 GT",
                year: 2024,
                km: 8000,
                price: 95000,
                image: "https://images.unsplash.com/photo-1583121274602-3e2820c69888?w=400"
            },
            {
                id: 5,
                name: "Honda Civic EX",
                year: 2023,
                km: 18000,
                price: 142000,
                image: "https://images.unsplash.com/photo-1606664515524-ed2f786a0bd6?w=400"
            },
            {
                id: 6,
                name: "Fiat Pulse Abarth",
                year: 2024,
                km: 3000,
                price: 118000,
                image: "https://images.unsplash.com/photo-1542362567-b07e54358753?w=400"
            },
            {
                id: 7,
                name: "Volkswagen T-Cross",
                year: 2023,
                km: 22000,
                price: 115000,
                image: "https://images.unsplash.com/photo-1581540222194-0def2dda95b8?w=400"
            },
            {
                id: 13,
                name: "Toyota Corolla XEi",
                year: 2024,
                km: 6000,
                price: 135000,
                image: "https://images.unsplash.com/photo-1621007947382-bb3c3994e3fb?w=400"
            },
            
            
        ];

        // Objeto para armazenar filtros ativos
        const activeFilters = {};
        const modalSelections = {};

        // Referências aos inputs de busca
        const searchInput = document.getElementById('searchInput');
        const filterSearchInputSmall = document.getElementById('filterSearchInputSmall');


        // Função para formatar preço
        function formatPrice(price) {
            return price.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }

        // Função para renderizar produtos
        function renderProducts(productsToRender) {
            const productsGrid = document.getElementById('productsGrid');
            
            if (productsToRender.length === 0) {
                productsGrid.innerHTML = `
                    <div class="no-products">
                        <i class="fas fa-car no-products-icon"></i>
                        <p class="no-products-text">Nenhum produto encontrado</p>
                    </div>
                `;
                return;
            }
            
            productsGrid.innerHTML = productsToRender.map(product => {
                // Lógica mantida para redirecionar o ID 1 para 'produto.html'
                const productHref = product.id === 1 ? 'produto.html' : `#produto-${product.id}`;
                
                return `
                    <a href="${productHref}" class="product-card">
                        <div class="product-image-container">
                            <img src="${product.image}" alt="${product.name}" class="product-image">
                            <div class="product-favorite">
                                <i class="far fa-heart"></i>
                            </div>
                        </div>
                        <div class="product-info">
                            <h3 class="product-name">${product.name}</h3>
                            <div class="product-details">
                                <span class="product-detail">
                                    <i class="far fa-calendar"></i>
                                    ${product.year}
                                </span>
                                <span class="product-detail">
                                    <i class="fas fa-tachometer-alt"></i>
                                    ${product.km.toLocaleString('pt-BR')} km
                                </span>
                            </div>
                            <div class="product-price">${formatPrice(product.price)}</div>
                        </div>
                    </a>
                `;
            }).join('');

            // Adicionar evento de clique nos corações
            document.querySelectorAll('.product-favorite').forEach(favorite => {
                favorite.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const icon = this.querySelector('i');
                    icon.classList.toggle('far');
                    icon.classList.toggle('fas');
                    this.style.background = icon.classList.contains('fas') ? '#e74c3c' : 'white';
                    this.style.color = icon.classList.contains('fas') ? 'white' : '#333';
                });
            });
        }

        // FUNÇÃO DE FILTRAGEM DE PRODUTOS PRINCIPAL
        function applyFiltersToProducts() {
            let filteredProducts = products;
            
            // Captura o termo de busca dos dois campos.
            const mainSearchTerm = searchInput.value.toLowerCase();
            const filterSearchTerm = filterSearchInputSmall.value.toLowerCase();
            
            // Define o termo de busca. Prioriza o input principal (topo), senão usa o input de filtro.
            let finalSearchTerm = mainSearchTerm || filterSearchTerm; 
            
            if (finalSearchTerm) {
                // Filtra os produtos pelo nome
                filteredProducts = filteredProducts.filter(product => 
                    product.name.toLowerCase().includes(finalSearchTerm)
                );
            }
            
            // Aqui você adicionaria a lógica de filtragem real baseada em activeFilters (Marca, Categoria, etc.)
            
            renderProducts(filteredProducts);
        }

        // EVENT LISTENER: Busca principal no topo
        if (searchInput) {
            searchInput.addEventListener('input', function() {
                applyFiltersToProducts();
            });
        }

        // EVENT LISTENER: Barra de pesquisa pequena no filtro (AGORA FILTRA PRODUTOS)
        if (filterSearchInputSmall) {
            filterSearchInputSmall.addEventListener('input', function() {
                applyFiltersToProducts();
            });
        }

        // Renderizar produtos iniciais
        renderProducts(products);


        // Carrossel de marcas
        let scrollPosition = 0;
        const brandsList = document.querySelector('.brands-list');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');

        prevBtn.addEventListener('click', () => {
            scrollPosition = Math.max(0, scrollPosition - 300);
            brandsList.style.transform = `translateX(-${scrollPosition}px)`;
        });

        nextBtn.addEventListener('click', () => {
            const maxScroll = brandsList.scrollWidth - brandsList.parentElement.offsetWidth;
            scrollPosition = Math.min(maxScroll, scrollPosition + 300);
            brandsList.style.transform = `translateX(-${scrollPosition}px)`;
        });

        // Transição suave para o carrossel
        brandsList.style.transition = 'transform 0.3s ease';

        // Sistema de Modais
        function openModal(filterType) {
            const modal = document.getElementById(`modal${capitalize(filterType)}`);
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function capitalize(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        // Evento de clique nos botões de filtro
        document.querySelectorAll('.filter-button').forEach(button => {
            button.addEventListener('click', function() {
                const filterType = this.getAttribute('data-filter');
                openModal(filterType);
            });
        });

        // Fechar modal ao clicar fora
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal(this.id);
                }
            });
        });

        // Seleção de opções no modal
        document.querySelectorAll('.modal-option').forEach(option => {
            option.addEventListener('click', function() {
                const modalContent = this.closest('.modal-content');
                const modalId = this.closest('.modal').id;
                const filterType = modalId.replace('modal', '').toLowerCase();
                
                // Permitir múltipla seleção
                this.classList.toggle('selected');
            });
        });

        // Busca dentro dos modais
        ['Marca', 'Categoria', 'Cor', 'Localizacao'].forEach(filterType => {
            const searchInputModal = document.getElementById(`search${filterType}`);
            if (searchInputModal) {
                searchInputModal.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    const options = document.querySelectorAll(`#options${filterType} .modal-option`);
                    
                    options.forEach(option => {
                        const text = option.textContent.toLowerCase();
                        if (text.includes(searchTerm)) {
                            option.style.display = 'block';
                        } else {
                            option.style.display = 'none';
                        }
                    });
                });
            }
        });

        // Limpar seleção do modal
        function clearModalSelection(filterType) {
            const options = document.querySelectorAll(`#options${capitalize(filterType)} .modal-option`);
            options.forEach(option => option.classList.remove('selected'));
            modalSelections[filterType] = [];
        }

        // Aplicar filtro
        function applyFilter(filterType) {
            const options = document.querySelectorAll(`#options${capitalize(filterType)} .modal-option.selected`);
            const selectedValues = Array.from(options).map(opt => ({
                value: opt.getAttribute('data-value'),
                label: opt.textContent
            }));
            
            if (selectedValues.length > 0) {
                activeFilters[filterType] = selectedValues;
            } else {
                delete activeFilters[filterType];
            }
            
            closeModal(`modal${capitalize(filterType)}`);
            renderActiveFilters();
            applyFiltersToProducts();
        }

        // Renderizar tags de filtros ativos
        function renderActiveFilters() {
            const container = document.getElementById('activeFilters');
            container.innerHTML = '';
            
            Object.keys(activeFilters).forEach(filterType => {
                activeFilters[filterType].forEach(filter => {
                    const tag = document.createElement('div');
                    tag.className = 'filter-tag';
                    tag.innerHTML = `
                        <span>${capitalize(filterType)}: ${filter.label}</span>
                        <span class="filter-tag-close" onclick="removeFilter('${filterType}', '${filter.value}')">×</span>
                    `;
                    container.appendChild(tag);
                });
            });
        }

        // Remover filtro específico
        function removeFilter(filterType, value) {
            activeFilters[filterType] = activeFilters[filterType].filter(f => f.value !== value);
            
            if (activeFilters[filterType].length === 0) {
                delete activeFilters[filterType];
            }
            
            // Desmarcar a opção no modal
            const option = document.querySelector(`#options${capitalize(filterType)} .modal-option[data-value="${value}"]`);
            if (option) {
                option.classList.remove('selected');
            }
            
            renderActiveFilters();
            applyFiltersToProducts();
        }
    </script>

</body>
</html>